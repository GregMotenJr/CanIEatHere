@model CanIEatHere.Models.Restaurant

@{
    ViewBag.Title = "Details";
}


<div class="jumbotron">
    <p class="hide" id="placeID">@Html.DisplayFor(model => model.PlaceID)</p>
   
     <h2 id="restaurantName" class="text-center"></h2>
 
   
    <h3>Address: <span id="restaurantAddress"></span></h3>
    <h3>Phone: <span id="restaurantPhoneNumber"></span></h3>
    <h3>Open Now? <span id="openNow"></span></h3>
    <h3>Hours: </h3>
    <ul id="restaurantHours"></ul>
    <br />
    <h5>Restaurant Details courtesy of Google Places</h5>
</div>
<hr />
<div>
    <h2 class="text-center">Reviews</h2>
    <div class="row">

        @foreach (var review in Model.Reviews)
        {
            <div class="col-md-4 col-sm-12">
                <div class="thumbnail">
                    <div class="caption">
                        <dl class="class-horizontal">
                            @*<dt>
                    @Html.DisplayNameFor(model => review.UserID)
                </dt>
                <dd>
                    @Html.DisplayFor(model => review.UserID)
                </dd>*@
                            <dt>
                                @Html.LabelFor(model => review.GeneralComments, "Review :")
                            </dt>
                            <dd>
                                @Html.DisplayFor(model => review.GeneralComments)
                            </dd>

                            <dt>
                                @Html.LabelFor(model => review.NumFoodOptionsRating, "Number of Food Options:")
                            </dt>
                            <dd>
                                @Html.DisplayFor(model => review.NumFoodOptions)
                            </dd>
                         
                            <dt>
                                @Html.LabelFor(model => review.OverallRating, "Overall Rating")
                            </dt>
                            <dd>
                                @Html.DisplayFor(model => review.OverallRating)
                            </dd>
                            <dt>
                               @Html.LabelFor(model => review.TimeStamp, "Date:")
                            </dt>
                            <dd>
                                @Html.DisplayFor(model => review.TimeStamp)
                            </dd>
                            <dt>
                               @Html.LabelFor(model => review.RestaurantPriceRating, "Restaurant Price Rating:")
                            </dt>
                            <dd>
                                @Html.DisplayFor(model => review.RestaurantPriceRating)
                            </dd>


                        </dl>
                        <button class="btn btn-default">@Html.ActionLink("See Full Review", "Details", "Reviews", new { id = review.ReviewID }, new { @class="detailsButton"})</button>
                    </div>
                </div>
            </div>
        }

    </div>

</div>
@*<p>
    @Html.ActionLink("Edit", "Edit", new { id = Model.restaurant.RestaurantID }) |
    @Html.ActionLink("Back to List", "Index")
</p>*@
<script>
    var placeID = $("#placeID").text();
    $(document).ready(function(){
        $.get("@Url.Action("GetDetailsFromPlaceID", "Restaurants", new { placeIdString = "tempVar" })".replace("tempVar", placeID), function (response) {
            console.log(response);
            $("#restaurantName").text(response.result.name);
            $("#restaurantAddress").text(response.result.formatted_address);
            $("#restaurantPhoneNumber").text(response.result.formatted_phone_number);
           
            if(response.result.opening_hours.open_now == false)
            {
                $("#openNow").text("Nope, try again later");
            }
            else if(response.result.opening_hours.open_now == "true")
            {
                $("#openNow").text("Yep, come on down");
            }

            (response.result.opening_hours.weekday_text).forEach(function (day) {
                
                day = day.replace('â€“', '-')
                $("#restaurantHours").append("<li>" + day + "</li>")

            });
            
        });
    });
</script>
